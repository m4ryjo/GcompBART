c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
BM$continuous
n_burn <- 10
n_thin <- 1
n_save <- 10
n_J <- 100
set.seed(1234)
sim_lfried <- function(N, P, Sigma, sigma, lambda) {
rawvars <- mvrnorm(N, rep(0, P), Sigma)
X <- pnorm(rawvars)
mu <- lambda[1] * (10 * sin(pi * X[,1] * X[,2]) + 20 * (X[,3] - 0.5)^2 + 10 * X[,4] + 5 * X[,5]) +
lambda[2] * (10 * sin(pi * X[,6] * X[,7]) + 20 * (X[,8] - 0.5)^2 + 10 * X[,9] + 5 * X[,10]) +
lambda[3] * (10 * sin(pi * X[,11] * X[,12]) + 20 * (X[,13] - 0.5)^2 + 10 * X[,14] + 5 * X[,15]) +
lambda[4] * (10 * sin(pi * X[,16] * X[,17]) + 20 * (X[,18] - 0.5)^2 + 10 * X[,19] + 5 * X[,20])
Y <- mu + sigma * rnorm(N)
return(data.frame(X = X, Y = Y, mu = mu))
}
## Simiulate dataset
n <- 100
times_sim <- rep(1:4, each = 5) # grouping variable
lambda <- c(0.25,0.5,0.75,1)
a1 <- 0.4
a2 <- 0.2
a3 <- 0.1
sig <- 10
Sig<-matrix(c(c(1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0,0),
c(0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0),
c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
names(BM)
BM$continuous
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
n_burn <- 10
n_thin <- 1
n_save <- 10
n_J <- 100
set.seed(1234)
sim_lfried <- function(N, P, Sigma, sigma, lambda) {
rawvars <- mvrnorm(N, rep(0, P), Sigma)
X <- pnorm(rawvars)
mu <- lambda[1] * (10 * sin(pi * X[,1] * X[,2]) + 20 * (X[,3] - 0.5)^2 + 10 * X[,4] + 5 * X[,5]) +
lambda[2] * (10 * sin(pi * X[,6] * X[,7]) + 20 * (X[,8] - 0.5)^2 + 10 * X[,9] + 5 * X[,10]) +
lambda[3] * (10 * sin(pi * X[,11] * X[,12]) + 20 * (X[,13] - 0.5)^2 + 10 * X[,14] + 5 * X[,15]) +
lambda[4] * (10 * sin(pi * X[,16] * X[,17]) + 20 * (X[,18] - 0.5)^2 + 10 * X[,19] + 5 * X[,20])
Y <- mu + sigma * rnorm(N)
return(data.frame(X = X, Y = Y, mu = mu))
}
## Simiulate dataset
n <- 100
times_sim <- rep(1:4, each = 5) # grouping variable
lambda <- c(0.25,0.5,0.75,1)
a1 <- 0.4
a2 <- 0.2
a3 <- 0.1
sig <- 10
Sig<-matrix(c(c(1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0,0),
c(0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0),
c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
## Results
warnings()
n_burn <- 10
n_thin <- 1
n_save <- 10
n_J <- 100
set.seed(1234)
sim_lfried <- function(N, P, Sigma, sigma, lambda) {
rawvars <- mvrnorm(N, rep(0, P), Sigma)
X <- pnorm(rawvars)
mu <- lambda[1] * (10 * sin(pi * X[,1] * X[,2]) + 20 * (X[,3] - 0.5)^2 + 10 * X[,4] + 5 * X[,5]) +
lambda[2] * (10 * sin(pi * X[,6] * X[,7]) + 20 * (X[,8] - 0.5)^2 + 10 * X[,9] + 5 * X[,10]) +
lambda[3] * (10 * sin(pi * X[,11] * X[,12]) + 20 * (X[,13] - 0.5)^2 + 10 * X[,14] + 5 * X[,15]) +
lambda[4] * (10 * sin(pi * X[,16] * X[,17]) + 20 * (X[,18] - 0.5)^2 + 10 * X[,19] + 5 * X[,20])
Y <- mu + sigma * rnorm(N)
return(data.frame(X = X, Y = Y, mu = mu))
}
## Simiulate dataset
n <- 100
times_sim <- rep(1:4, each = 5) # grouping variable
lambda <- c(0.25,0.5,0.75,1)
a1 <- 0.4
a2 <- 0.2
a3 <- 0.1
sig <- 10
Sig<-matrix(c(c(1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0,0),
c(0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0),
c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
## Results
out_gcomp$summary_out
warnings()
bm_out <- BM
bm_out$BModels
is.list(bm_out$BModels)
bm_out$BModels[[1]]
bm_out$BModels[[2]]
bm_out$BModels[[6]]
BM[[6]]$reg_forest$get_sigma() * sd_Y
BM[[6]]
BM
BM$BModels[[6]]
BM$BModels[[6]]$reg_forest$get_sigma() * sd_Y
BM$BModels[[6]]$reg_forest$get_sigma()
out_gcomp
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
warnings()
n_burn <- 10
n_thin <- 1
n_save <- 10
n_J <- 100
set.seed(1234)
sim_lfried <- function(N, P, Sigma, sigma, lambda) {
rawvars <- mvrnorm(N, rep(0, P), Sigma)
X <- pnorm(rawvars)
mu <- lambda[1] * (10 * sin(pi * X[,1] * X[,2]) + 20 * (X[,3] - 0.5)^2 + 10 * X[,4] + 5 * X[,5]) +
lambda[2] * (10 * sin(pi * X[,6] * X[,7]) + 20 * (X[,8] - 0.5)^2 + 10 * X[,9] + 5 * X[,10]) +
lambda[3] * (10 * sin(pi * X[,11] * X[,12]) + 20 * (X[,13] - 0.5)^2 + 10 * X[,14] + 5 * X[,15]) +
lambda[4] * (10 * sin(pi * X[,16] * X[,17]) + 20 * (X[,18] - 0.5)^2 + 10 * X[,19] + 5 * X[,20])
Y <- mu + sigma * rnorm(N)
return(data.frame(X = X, Y = Y, mu = mu))
}
## Simiulate dataset
n <- 100
times_sim <- rep(1:4, each = 5) # grouping variable
lambda <- c(0.25,0.5,0.75,1)
a1 <- 0.4
a2 <- 0.2
a3 <- 0.1
sig <- 10
Sig<-matrix(c(c(1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0,0),
c(0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0),
c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
## Results
out_gcomp$summary_out
summary(training_data)
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::document()
list = c("sim_lfried")
rm(list = c("sim_lfried"))
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
n_burn <- 10
n_thin <- 1
n_save <- 10
n_J <- 100
set.seed(1234)
sim_lfried <- function(N, P, Sigma, sigma, lambda) {
rawvars <- mvrnorm(N, rep(0, P), Sigma)
X <- pnorm(rawvars)
mu <- lambda[1] * (10 * sin(pi * X[,1] * X[,2]) + 20 * (X[,3] - 0.5)^2 + 10 * X[,4] + 5 * X[,5]) +
lambda[2] * (10 * sin(pi * X[,6] * X[,7]) + 20 * (X[,8] - 0.5)^2 + 10 * X[,9] + 5 * X[,10]) +
lambda[3] * (10 * sin(pi * X[,11] * X[,12]) + 20 * (X[,13] - 0.5)^2 + 10 * X[,14] + 5 * X[,15]) +
lambda[4] * (10 * sin(pi * X[,16] * X[,17]) + 20 * (X[,18] - 0.5)^2 + 10 * X[,19] + 5 * X[,20])
Y <- mu + sigma * rnorm(N)
return(data.frame(X = X, Y = Y, mu = mu))
}
## Simiulate dataset
n <- 100
times_sim <- rep(1:4, each = 5) # grouping variable
lambda <- c(0.25,0.5,0.75,1)
a1 <- 0.4
a2 <- 0.2
a3 <- 0.1
sig <- 10
Sig<-matrix(c(c(1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0,0),
c(0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0,0),
c(0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0,0),
c(0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3,0),
c(0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0,a3),
c(a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0,0),
c(0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0,0),
c(0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0,0),
c(0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2,0),
c(0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0,a2),
c(a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0,0),
c(0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0,0),
c(0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0,0),
c(0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1,0),
c(0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0,a1),
c(a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0,0),
c(0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0,0),
c(0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0,0),
c(0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1,0),
c(0,0,0,0,a3,0,0,0,0,a2,0,0,0,0,a1,0,0,0,0,1)), 20, 20, byrow = TRUE)
vartype_bl <- c(rep("X0", 5), rep("X", 15), "Y")
tgroup <- c(rep(1:4,each=5),4)
training_data <- sim_lfried(n, 20, Sig, sig, lambda)
## Fit the model and perform g-computation
BM <- BMfits(training_data[,1:21],
var.type = vartype_bl,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
out_gcomp <- gcompbart(training_data[,1:21],
BModels = BM,
var.type = vartype_bl,
J = n_J,
opts = Opts(num_burn = n_burn,
num_thin = n_thin,
num_save = n_save,
update_s = TRUE,
update_alpha = TRUE,
update_tvp = FALSE,
update_alpha_vec = FALSE,
update_eta = FALSE,
update_phi = FALSE,
update_tau = TRUE,
update_sigma_mu = TRUE), # opts see SoftBart
tgroup = tgroup)
## Results
out_gcomp$summary_out
devtools::install()
devtools::clean_dll()
devtools::build()
install.packages("GcompBART_0.1.0.tar.gz", repos = NULL, type = "source")
setwd("~/Documents/Rpackages/GcompBART")
install.packages("GcompBART_0.1.0.tar.gz", repos = NULL, type = "source")
file.exists("GcompBART_0.1.0.tar.gz")
file.exists("GcompBART_0.1.0.tar.gz")
file.exists("GcompBART_0.1.0.tar.gz")
install.packages("GcompBART_0.1.0.tar.gz", repos = NULL, type = "source")
library(GcompBART)
remove.packages("GcompBART")
devtools::clean_dll()
devtools::build()
install.packages("GcompBART_0.1.0.tar.gz", repos = NULL, type = "source")
untar("/full/path/to/GcompBART_0.1.0.tar.gz", list = TRUE)
